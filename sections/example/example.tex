In practice, likelihoods such as those discussed above are used to estimate physical parameters from data. As discussed in Sec.~\ref{sec:intro}, weighted MC is often used to compute the likelihood of a particular physical scenario given the observed data. Statements are then made about the physical scenarios either by maximizing the likelihood or by examining the posterior distribution assuming some priors. We examine a toy experiment where we measure the mode, $\Omega$, and normalization, $\Phi$, of a Gaussian-distributed signal against a steeply falling inverse power-law background. The performance of $\mcl$ is evaluated and compared against other likelihoods.

For our toy experiment, we generate the true energies, $E_t$, of synthetic data events from a background falling as $(E_t/100 \mathrm{GeV})^{-\gamma_t^b}$, where $\gamma_t^b=3.07$, and a Gaussian signal centered at $\Omega_t=125$~GeV with width of $\sigma_t=2$~GeV and normalization $\Phi_t=5013$ for a fixed number of expected events. Our imaginary detector is sensitive in the 100--160~GeV range. To simulate the effect of a real detector, the true energy, $E_t$, is smeared by 5\% for background and 3\% for signal to obtain event-by-event reconstructed energies, $E_r$. We generate a total number of MC events, $N_{\mathrm{MC}}$, split evenly between the components. Generation is performed assuming inverse power-law distributions of $(E_t/100 \mathrm{GeV})^{-\gamma_g}$ for signal and $(E_t/100 \mathrm{GeV})^{-\gamma_g^b}$ for background. We choose $\gamma_g=1$ and $\gamma_g^b=2$. Reweighting of the MC can then be performed as a function of $E_t$ and forward-folded onto distributions in $E_r$ over which the events are histogrammed and likelihoods evaluated. A diagram of the steps described above is shown in Fig.~\ref{fig:mc_diagram}. For all toy experiments, the background component, $(\Phi^b,\gamma^b)$, and the signal width, $\sigma$, are kept fixed to their true values. Only the signal mean, $\Omega$, and normalization, $\Phi$, are treated as free parameters.

\begin{figure}[htp]
\resizebox{\textwidth}{!}{
\begin{tikzpicture}[node distance=1cm, auto,]

%nodes
\node[solidbox] (mc_generation) {\centering {\bf MC generation} \\
	\begin{center}
		Signal $\sim$ PowerLaw($\gamma_g$) \\
		Background  $\sim$ PowerLaw($\gamma_g^b$)
	\end{center}
};

\node[solidbox, right=of mc_generation] (detector_simulation) {\centering {\bf Detector simulation} \\
    \begin{center}
	Smearing to mimic\\ detector response.
	\end{center}
};

\node[solidbox,right=of detector_simulation] (reweighting) {\centering {\bf Reweighting} \\
	Reweight MC to a physical\\  hypothesis $\vec\theta = (\Phi^{b},\gamma^b,\Phi,\Omega,\sigma)$
	\begin{center}
		Signal $\sim$ Gaussian($\Omega,\sigma$) \\
		Background $\sim$ PowerLaw($\gamma^b$)
	\end{center}
};

\node[solidbox,below=of reweighting] (mc_histogram) {\centering {\bf Histogram MC} \\
	Binned MC expectation.
};

\node[solidbox, below=of mc_generation] (data_generation) {\centering {\bf Synthetic data generation} \\
	Produce data according to\\ $\vec\theta_{\mathrm{true}} = (\Phi_t^{b},\gamma_t^b,\Phi_t,\Omega_t,\sigma_t)$
	\begin{center}
		Signal $\sim$ Gaussian($\Omega_t,\sigma_t$) \\
		Background $\sim$ PowerLaw($\gamma_t^b$)
	\end{center}
};

\node[solidbox, right=of data_generation] (data_detector_simulation) {\centering {\bf Detector simulation} \\
    \begin{center}
	Smearing to mimic\\ detector response.
	\end{center}
};

\node[solidbox,below=of mc_histogram] (data_histogram) {\centering {\bf Histogram Data} \\
	Binned synthetic data.
};

\node[circle, minimum size=1cm, color=black, draw=black, very thick, right=of data_histogram] (likelihood) {\centering {\bf $\mathcal{L}(\vec\theta)$}
};

% arrows

\draw [->,line width=1.5pt] (mc_generation) -- (detector_simulation);
\draw [->,line width=1.5pt] (detector_simulation) -- (reweighting);
\draw [->,line width=1.5pt] (reweighting) -- (mc_histogram);
\draw [->,line width=1.5pt] (mc_histogram) -| (likelihood);

\draw [->,line width=1.5pt] (data_generation) -- (data_detector_simulation);
\draw [->,line width=1.5pt] (data_detector_simulation.east) |- ($(data_detector_simulation.east) + (1.2,0.0)$) |- (data_histogram.west);
\draw [->,line width=1.5pt] (data_histogram) -- (likelihood);

% boxes

\begin{pgfonlayer}{background}
  \node[bigboxGeneration] [fit = (mc_generation) (data_generation)] {};
\end{pgfonlayer}

\begin{pgfonlayer}{background}
  \node[bigboxDetector] [fit = (detector_simulation) (data_detector_simulation)] {};
\end{pgfonlayer}

\begin{pgfonlayer}{background}
  \node[bigboxAnalysis] [fit = (reweighting) (mc_histogram) (data_histogram) (likelihood)] {};
\end{pgfonlayer}
\end{tikzpicture}
}% end resize box
\caption{\textbf{\textit{Diagram of toy experiment steps.}} The three colored boxes indicate the three steps of our toy experiment. The left box (almond) summarizes the MC and data generation. The center box (salmon) indicates the step in which we apply the detector response. The right box (lilac) summarizes the MC reweighting, data and MC histogramming, and final likelihood evaluation from the histograms. This final lilac box is repeated for each likelihood evaluation.}
\label{fig:mc_diagram}
\end{figure}
